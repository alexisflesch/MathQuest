[TypeScript] Successfully registered ts-node for TypeScript file handling
Could not find trigger functions directly, trying delayed import
Could not find handler function directly, trying delayed import
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/lockHandler.ts
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/unlockHandler.ts
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/endHandler.ts
[2025-05-11 09:47:20.855] [36m[DEBUG][0m [EndQuizHandler] [handleEnd] tournamentState: {}
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/pauseHandler.ts
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/resumeHandler.ts
Failed to load TypeScript handler directly, falling back to legacy: Cannot find module '/home/aflesch/mathquest/app/sockets/quizState' imported from /home/aflesch/mathquest/app/sockets/quizEventHandlers/closeQuestionHandler.ts
Could not find calculateScore function directly, trying delayed import
(node:100897) Warning: Accessing non-existent property 'triggerTournamentQuestion' of module exports inside circular dependency
(Use `node --trace-warnings ...` to show where the warning was created)
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
(node:100897) ExperimentalWarning: CommonJS module /home/aflesch/mathquest/app/sockets/quizEventHandlers/lockHandler.js is loading ES Module /home/aflesch/mathquest/app/sockets/quizEventHandlers/lockHandler.ts using require().
Support for loading ES Module in require() is an experimental feature and might change at any time
(node:100897) Warning: Accessing non-existent property 'calculateScore' of module exports inside circular dependency
(node:100897) Warning: Accessing non-existent property 'default' of module exports inside circular dependency
[2025-05-11 09:47:23.629] [32m[INFO][0m [Server] Server ready on http://localhost:3007
 â—‹ Compiling / ...
 âœ“ Compiled / in 4.8s (828 modules)
 GET / 200 in 6313ms
 âœ“ Compiled in 1441ms (375 modules)
 â—‹ Compiling /api/auth/status ...
 âœ“ Compiled /api/auth/status in 1726ms (839 modules)
 GET /api/auth/status 200 in 2461ms
 â—‹ Compiling /teacher/home ...
 âœ“ Compiled /teacher/home in 1491ms (865 modules)
 GET /teacher/home 200 in 1994ms
 GET /api/teacher/profile?id=8faeb437-06ca-496c-9b27-2d3f1a5156dc 200 in 2123ms
 â—‹ Compiling /my-tournaments ...
 âœ“ Compiled /my-tournaments in 698ms (876 modules)
 GET /my-tournaments 200 in 904ms
 âœ“ Compiled /api/my-tournaments in 398ms (878 modules)
 GET /api/my-tournaments?cookie_id=teacher_8faeb437-06ca-496c-9b27-2d3f1a5156dc 200 in 709ms
 GET /api/my-tournaments?cookie_id=teacher_8faeb437-06ca-496c-9b27-2d3f1a5156dc 200 in 70ms
 â—‹ Compiling /lobby/[code] ...
 âœ“ Compiled /lobby/[code] in 1518ms (995 modules)
 GET /lobby/403128 200 in 2314ms
[2025-05-11 09:48:05.110] [32m[INFO][0m [Server] New connection: socket.id=pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.111] [36m[DEBUG][0m [TournamentHandler] Registering tournament handlers for socket pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.112] [36m[DEBUG][0m [QuizHandler] Registering quiz handlers for socket pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.113] [32m[INFO][0m [QuizEvents] [DEBUG] registerQuizEvents for socket.id=pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.116] [36m[DEBUG][0m [QuizHandler] [QuizHandler] Sockets in room dashboard_undefined: []
[2025-05-11 09:48:05.150] [32m[INFO][0m [LobbyHandler] join_lobby received: code=403128, pseudo=Alexis, cookie_id=teacher_8faeb437-06ca-496c-9b27-2d3f1a5156dc, socket.id=pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.151] [36m[DEBUG][0m [LobbyHandler] Avatar for Alexis: /avatars/rat.svg
[2025-05-11 09:48:05.151] [36m[DEBUG][0m [LobbyHandler] Fetching tournament status for code 403128...
[2025-05-11 09:48:05.184] [36m[DEBUG][0m [LobbyHandler] get_participants: code=403128, socket.id=pPIkcHaXF5nHVLlqAAAC
[2025-05-11 09:48:05.184] [36m[DEBUG][0m [LobbyHandler] lobbyParticipants[403128] on get_participants: undefined
[2025-05-11 09:48:05.322] [32m[INFO][0m [LobbyHandler] Tournament 403128 status found: en prÃ©paration
[2025-05-11 09:48:05.322] [32m[INFO][0m [LobbyHandler] Tournament 403128 is 'en prÃ©paration'. Proceeding to join lobby for socket pPIkcHaXF5nHVLlqAAAC.
[2025-05-11 09:48:05.502] [32m[INFO][0m [LobbyHandler] [DEBUG] After join, socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:05.503] [36m[DEBUG][0m [LobbyHandler] Socket pPIkcHaXF5nHVLlqAAAC joined ONLY the lobby_403128 room
[2025-05-11 09:48:05.503] [36m[DEBUG][0m [LobbyHandler] lobbyParticipants[403128]: [
  {
    id: 'pPIkcHaXF5nHVLlqAAAC',
    pseudo: 'Alexis',
    avatar: '/avatars/rat.svg',
    cookie_id: 'teacher_8faeb437-06ca-496c-9b27-2d3f1a5156dc'
  }
]
 â—‹ Compiling /api/tournament-status ...
 âœ“ Compiled /api/tournament-status in 592ms (997 modules)
 GET /api/tournament-status?code=403128 200 in 820ms
 GET /api/tournament-status?code=403128 200 in 42ms
 âœ“ Compiled /api/tournament in 488ms (1000 modules)
 GET /api/tournament?code=403128 200 in 669ms
 GET /api/tournament-status?code=403128 200 in 665ms
[2025-05-11 09:48:06.666] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
 â—‹ Compiling /api/joueur ...
 âœ“ Compiled /api/joueur in 622ms (1002 modules)
[2025-05-11 09:48:07.180] [36m[DEBUG][0m [API:Joueur] Requested id: eee24868-a897-4dd8-a8ff-b7f0da0c6d6b
[2025-05-11 09:48:07.311] [36m[DEBUG][0m [API:Joueur] Found joueur: { id: 'eee24868-a897-4dd8-a8ff-b7f0da0c6d6b', pseudo: 'Alexis' }
 GET /api/joueur?id=eee24868-a897-4dd8-a8ff-b7f0da0c6d6b 200 in 817ms
 GET /api/tournament?code=403128 200 in 826ms
 GET /api/tournament-status?code=403128 200 in 839ms
[2025-05-11 09:48:07.395] [36m[DEBUG][0m [API:Joueur] Requested id: eee24868-a897-4dd8-a8ff-b7f0da0c6d6b
[2025-05-11 09:48:07.397] [36m[DEBUG][0m [API:Joueur] Found joueur: { id: 'eee24868-a897-4dd8-a8ff-b7f0da0c6d6b', pseudo: 'Alexis' }
 GET /api/joueur?id=eee24868-a897-4dd8-a8ff-b7f0da0c6d6b 200 in 22ms
[2025-05-11 09:48:07.667] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:08.668] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:09.668] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:10.669] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:11.671] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:12.671] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:13.672] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:14.673] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
 â¨¯ uncaughtException: TypeError: handleStartTournament is not a function
    at Socket.<anonymous> (sockets/tournamentEvents.js:10:48)
 â¨¯ uncaughtException:  TypeError: handleStartTournament is not a function
    at Socket.<anonymous> (sockets/tournamentEvents.js:10:48)
[2025-05-11 09:48:15.673] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:16.674] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:17.674] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:18.676] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:19.678] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:20.679] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:21.680] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
[2025-05-11 09:48:22.681] [36m[DEBUG][0m [LobbyHandler] [STATUS CHECK] Socket pPIkcHaXF5nHVLlqAAAC rooms: [ 'pPIkcHaXF5nHVLlqAAAC', 'lobby_403128' ]
